{"ast":null,"code":"import { useTheme as _useTheme } from \"styled-components\";\nimport _styled from \"styled-components\";\nvar _jsxFileName = \"/home/diep/freelance/interface/src/components/FiatOnrampModal/index.tsx\",\n  _s = $RefreshSig$();\nimport { Trans } from \"@lingui/react\";\nimport { useWeb3React } from '@web3-react/core';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useCloseModal, useModalIsOpen } from 'state/application/hooks';\nimport { ApplicationModal } from 'state/application/reducer';\nimport { CustomLightSpinner, ThemedText } from 'theme';\nimport { useIsDarkMode } from 'theme/components/ThemeToggle';\nimport Circle from \"../../assets/images/blue-loader.svg\";\nimport Modal from '../Modal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst MOONPAY_DARK_BACKGROUND = '#1c1c1e';\nconst Wrapper = _styled.div.withConfig({\n  displayName: \"FiatOnrampModal__Wrapper\",\n  componentId: \"sc-jqtzb4-0\"\n})([\"background-color:\", \";border-radius:20px;box-shadow:\", \";display:flex;flex-flow:column nowrap;margin:0;min-height:720px;min-width:375px;position:relative;width:100%;\"], _ref => {\n  let {\n    isDarkMode,\n    theme\n  } = _ref;\n  return isDarkMode ? MOONPAY_DARK_BACKGROUND : theme.white;\n}, _ref2 => {\n  let {\n    theme\n  } = _ref2;\n  return theme.deepShadow;\n});\nconst ErrorText = _styled(ThemedText.BodyPrimary).withConfig({\n  displayName: \"FiatOnrampModal__ErrorText\",\n  componentId: \"sc-jqtzb4-1\"\n})([\"color:\", \";margin:auto !important;text-align:center;width:90%;\"], _ref3 => {\n  let {\n    theme\n  } = _ref3;\n  return theme.accentFailure;\n});\nconst StyledIframe = _styled.iframe.withConfig({\n  displayName: \"FiatOnrampModal__StyledIframe\",\n  componentId: \"sc-jqtzb4-2\"\n})([\"background-color:\", \";border-radius:12px;bottom:0;left:0;height:calc(100% - 16px);margin:8px;padding:0;position:absolute;right:0;top:0;width:calc(100% - 16px);\"], _ref4 => {\n  let {\n    isDarkMode,\n    theme\n  } = _ref4;\n  return isDarkMode ? MOONPAY_DARK_BACKGROUND : theme.white;\n});\nconst StyledSpinner = _styled(CustomLightSpinner).withConfig({\n  displayName: \"FiatOnrampModal__StyledSpinner\",\n  componentId: \"sc-jqtzb4-3\"\n})([\"bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;\"]);\nconst MOONPAY_SUPPORTED_CURRENCY_CODES = ['eth', 'eth_arbitrum', 'eth_optimism', 'eth_polygon', 'weth', 'wbtc', 'matic_polygon', 'polygon', 'usdc_arbitrum', 'usdc_optimism', 'usdc_polygon'];\nexport default function FiatOnrampModal() {\n  _s();\n  const {\n    account\n  } = useWeb3React();\n  const theme = _useTheme();\n  const isDarkMode = useIsDarkMode();\n  const closeModal = useCloseModal();\n  const fiatOnrampModalOpen = useModalIsOpen(ApplicationModal.FIAT_ONRAMP);\n  const [signedIframeUrl, setSignedIframeUrl] = useState(null);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const fetchSignedIframeUrl = useCallback(async () => {\n    if (!account) {\n      setError('Please connect an account before making a purchase.');\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      const signedIframeUrlFetchEndpoint = process.env.REACT_APP_MOONPAY_LINK;\n      const res = await fetch(signedIframeUrlFetchEndpoint, {\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        },\n        method: 'POST',\n        body: JSON.stringify({\n          theme: isDarkMode ? 'dark' : 'light',\n          colorCode: theme.accentAction,\n          defaultCurrencyCode: 'eth',\n          redirectUrl: 'https://app.uniswap.org/#/swap',\n          walletAddresses: JSON.stringify(MOONPAY_SUPPORTED_CURRENCY_CODES.reduce((acc, currencyCode) => ({\n            ...acc,\n            [currencyCode]: account\n          }), {}))\n        })\n      });\n      const {\n        url\n      } = await res.json();\n      setSignedIframeUrl(url);\n    } catch (e) {\n      console.log('there was an error fetching the link', e);\n      setError(e.toString());\n    } finally {\n      setLoading(false);\n    }\n  }, [account, isDarkMode, theme.accentAction]);\n  useEffect(() => {\n    fetchSignedIframeUrl();\n  }, [fetchSignedIframeUrl]);\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    isOpen: fiatOnrampModalOpen,\n    onDismiss: closeModal,\n    maxHeight: 720,\n    children: /*#__PURE__*/_jsxDEV(Wrapper, {\n      \"data-testid\": \"fiat-onramp-modal\",\n      isDarkMode: isDarkMode,\n      children: error ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(ThemedText.MediumHeader, {\n          children: /*#__PURE__*/_jsxDEV(Trans, {\n            id: \"Moonpay Fiat On-ramp iframe\"\n          }, void 0, false, void 0, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ErrorText, {\n          children: [/*#__PURE__*/_jsxDEV(Trans, {\n            id: \"something went wrong!\"\n          }, void 0, false, void 0, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this), error]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : loading ? /*#__PURE__*/_jsxDEV(StyledSpinner, {\n        src: Circle,\n        alt: \"loading spinner\",\n        size: \"90px\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(StyledIframe, {\n        src: signedIframeUrl !== null && signedIframeUrl !== void 0 ? signedIframeUrl : '',\n        frameBorder: \"0\",\n        title: \"fiat-onramp-iframe\",\n        isDarkMode: isDarkMode\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this);\n}\n_s(FiatOnrampModal, \"WjYeWuX2CiUGYBDJql8lEV6fIlI=\", false, function () {\n  return [useWeb3React, _useTheme, useIsDarkMode, useCloseModal, useModalIsOpen];\n});\n_c = FiatOnrampModal;\nvar _c;\n$RefreshReg$(_c, \"FiatOnrampModal\");","map":{"version":3,"names":["useWeb3React","useCallback","useEffect","useState","useCloseModal","useModalIsOpen","ApplicationModal","CustomLightSpinner","ThemedText","useIsDarkMode","Modal","MOONPAY_DARK_BACKGROUND","Wrapper","styled","div","isDarkMode","theme","white","deepShadow","ErrorText","BodyPrimary","accentFailure","StyledIframe","iframe","StyledSpinner","MOONPAY_SUPPORTED_CURRENCY_CODES","FiatOnrampModal","account","useTheme","closeModal","fiatOnrampModalOpen","FIAT_ONRAMP","signedIframeUrl","setSignedIframeUrl","error","setError","loading","setLoading","fetchSignedIframeUrl","signedIframeUrlFetchEndpoint","process","env","REACT_APP_MOONPAY_LINK","res","fetch","headers","Accept","method","body","JSON","stringify","colorCode","accentAction","defaultCurrencyCode","redirectUrl","walletAddresses","reduce","acc","currencyCode","url","json","e","console","log","toString","Circle"],"sources":["/home/diep/freelance/interface/src/components/FiatOnrampModal/index.tsx"],"sourcesContent":["import { Trans } from '@lingui/macro'\nimport { useWeb3React } from '@web3-react/core'\nimport { useCallback, useEffect, useState } from 'react'\nimport { useCloseModal, useModalIsOpen } from 'state/application/hooks'\nimport { ApplicationModal } from 'state/application/reducer'\nimport styled, { useTheme } from 'styled-components/macro'\nimport { CustomLightSpinner, ThemedText } from 'theme'\nimport { useIsDarkMode } from 'theme/components/ThemeToggle'\n\nimport Circle from '../../assets/images/blue-loader.svg'\nimport Modal from '../Modal'\n\nconst MOONPAY_DARK_BACKGROUND = '#1c1c1e'\nconst Wrapper = styled.div<{ isDarkMode: boolean }>`\n  // #1c1c1e is the background color for the darkmode moonpay iframe as of 2/16/2023\n  background-color: ${({ isDarkMode, theme }) => (isDarkMode ? MOONPAY_DARK_BACKGROUND : theme.white)};\n  border-radius: 20px;\n  box-shadow: ${({ theme }) => theme.deepShadow};\n  display: flex;\n  flex-flow: column nowrap;\n  margin: 0;\n  min-height: 720px;\n  min-width: 375px;\n  position: relative;\n  width: 100%;\n`\n\nconst ErrorText = styled(ThemedText.BodyPrimary)`\n  color: ${({ theme }) => theme.accentFailure};\n  margin: auto !important;\n  text-align: center;\n  width: 90%;\n`\nconst StyledIframe = styled.iframe<{ isDarkMode: boolean }>`\n  // #1c1c1e is the background color for the darkmode moonpay iframe as of 2/16/2023\n  background-color: ${({ isDarkMode, theme }) => (isDarkMode ? MOONPAY_DARK_BACKGROUND : theme.white)};\n  border-radius: 12px;\n  bottom: 0;\n  left: 0;\n  height: calc(100% - 16px);\n  margin: 8px;\n  padding: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: calc(100% - 16px);\n`\nconst StyledSpinner = styled(CustomLightSpinner)`\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n`\n\nconst MOONPAY_SUPPORTED_CURRENCY_CODES = [\n  'eth',\n  'eth_arbitrum',\n  'eth_optimism',\n  'eth_polygon',\n  'weth',\n  'wbtc',\n  'matic_polygon',\n  'polygon',\n  'usdc_arbitrum',\n  'usdc_optimism',\n  'usdc_polygon',\n]\n\nexport default function FiatOnrampModal() {\n  const { account } = useWeb3React()\n  const theme = useTheme()\n  const isDarkMode = useIsDarkMode()\n  const closeModal = useCloseModal()\n  const fiatOnrampModalOpen = useModalIsOpen(ApplicationModal.FIAT_ONRAMP)\n\n  const [signedIframeUrl, setSignedIframeUrl] = useState<string | null>(null)\n  const [error, setError] = useState<string | null>(null)\n  const [loading, setLoading] = useState(false)\n\n  const fetchSignedIframeUrl = useCallback(async () => {\n    if (!account) {\n      setError('Please connect an account before making a purchase.')\n      return\n    }\n    setLoading(true)\n    setError(null)\n    try {\n      const signedIframeUrlFetchEndpoint = process.env.REACT_APP_MOONPAY_LINK as string\n      const res = await fetch(signedIframeUrlFetchEndpoint, {\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n        },\n        method: 'POST',\n        body: JSON.stringify({\n          theme: isDarkMode ? 'dark' : 'light',\n          colorCode: theme.accentAction,\n          defaultCurrencyCode: 'eth',\n          redirectUrl: 'https://app.uniswap.org/#/swap',\n          walletAddresses: JSON.stringify(\n            MOONPAY_SUPPORTED_CURRENCY_CODES.reduce(\n              (acc, currencyCode) => ({\n                ...acc,\n                [currencyCode]: account,\n              }),\n              {}\n            )\n          ),\n        }),\n      })\n      const { url } = await res.json()\n      setSignedIframeUrl(url)\n    } catch (e) {\n      console.log('there was an error fetching the link', e)\n      setError(e.toString())\n    } finally {\n      setLoading(false)\n    }\n  }, [account, isDarkMode, theme.accentAction])\n\n  useEffect(() => {\n    fetchSignedIframeUrl()\n  }, [fetchSignedIframeUrl])\n\n  return (\n    <Modal isOpen={fiatOnrampModalOpen} onDismiss={closeModal} maxHeight={720}>\n      <Wrapper data-testid=\"fiat-onramp-modal\" isDarkMode={isDarkMode}>\n        {error ? (\n          <>\n            <ThemedText.MediumHeader>\n              <Trans>Moonpay Fiat On-ramp iframe</Trans>\n            </ThemedText.MediumHeader>\n            <ErrorText>\n              <Trans>something went wrong!</Trans>\n              <br />\n              {error}\n            </ErrorText>\n          </>\n        ) : loading ? (\n          <StyledSpinner src={Circle} alt=\"loading spinner\" size=\"90px\" />\n        ) : (\n          <StyledIframe\n            src={signedIframeUrl ?? ''}\n            frameBorder=\"0\"\n            title=\"fiat-onramp-iframe\"\n            isDarkMode={isDarkMode}\n          />\n        )}\n      </Wrapper>\n    </Modal>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}