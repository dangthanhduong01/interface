{"ast":null,"code":"import { keyframes as _keyframes } from \"styled-components\";\nimport _styled from \"styled-components\";\nvar _jsxFileName = \"/home/diep/freelance/interface/src/components/Polling/index.tsx\",\n  _s = $RefreshSig$();\nimport { Trans } from \"@lingui/react\";\nimport { useWeb3React } from '@web3-react/core';\nimport { RowFixed } from 'components/Row';\nimport { getChainInfo } from 'constants/chainInfo';\nimport useCurrentBlockTimestamp from 'hooks/useCurrentBlockTimestamp';\nimport { useIsLandingPage } from 'hooks/useIsLandingPage';\nimport { useIsNftPage } from 'hooks/useIsNftPage';\nimport useMachineTimeMs from 'hooks/useMachineTime';\nimport useBlockNumber from 'lib/hooks/useBlockNumber';\nimport { useEffect, useMemo, useState } from 'react';\nimport { ExternalLink, ThemedText } from 'theme';\nimport { ExplorerDataType, getExplorerLink } from 'utils/getExplorerLink';\nimport { MouseoverTooltip } from '../Tooltip';\nimport { ChainConnectivityWarning } from './ChainConnectivityWarning';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst StyledPolling = _styled.div.withConfig({\n  displayName: \"Polling__StyledPolling\",\n  componentId: \"sc-8msj8j-0\"\n})([\"align-items:center;bottom:0;color:\", \";display:none;padding:1rem;position:fixed;right:0;transition:250ms ease color;a{color:unset;}a:hover{color:unset;text-decoration:none;}@media screen and (min-width:\", \"px){display:flex;}\"], _ref => {\n  let {\n    theme\n  } = _ref;\n  return theme.textTertiary;\n}, _ref2 => {\n  let {\n    theme\n  } = _ref2;\n  return theme.breakpoint.md;\n});\nconst StyledPollingBlockNumber = _styled(ThemedText.DeprecatedSmall).withConfig({\n  displayName: \"Polling__StyledPollingBlockNumber\",\n  componentId: \"sc-8msj8j-1\"\n})([\"color:\", \";transition:opacity 0.25s ease;opacity:\", \";:hover{opacity:1;}a{color:unset;}a:hover{text-decoration:none;color:unset;}\"], _ref3 => {\n  let {\n    theme,\n    warning\n  } = _ref3;\n  return warning ? theme.deprecated_yellow3 : theme.accentSuccess;\n}, _ref4 => {\n  let {\n    breathe,\n    hovering\n  } = _ref4;\n  return hovering ? 0.7 : breathe ? 1 : 0.5;\n});\nconst StyledPollingDot = _styled.div.withConfig({\n  displayName: \"Polling__StyledPollingDot\",\n  componentId: \"sc-8msj8j-2\"\n})([\"width:8px;height:8px;min-height:8px;min-width:8px;border-radius:50%;position:relative;background-color:\", \";transition:250ms ease background-color;\"], _ref5 => {\n  let {\n    theme,\n    warning\n  } = _ref5;\n  return warning ? theme.deprecated_yellow3 : theme.accentSuccess;\n});\nconst rotate360 = _keyframes`\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n`;\nconst Spinner = _styled.div.withConfig({\n  displayName: \"Polling__Spinner\",\n  componentId: \"sc-8msj8j-3\"\n})([\"animation:\", \" 1s cubic-bezier(0.83,0,0.17,1) infinite;transform:translateZ(0);border-top:1px solid transparent;border-right:1px solid transparent;border-bottom:1px solid transparent;border-left:2px solid \", \";background:transparent;width:14px;height:14px;border-radius:50%;position:relative;transition:250ms ease border-color;left:-3px;top:-3px;\"], rotate360, _ref6 => {\n  let {\n    theme,\n    warning\n  } = _ref6;\n  return warning ? theme.deprecated_yellow3 : theme.accentSuccess;\n});\nconst DEFAULT_MS_BEFORE_WARNING = 600000;\nconst NETWORK_HEALTH_CHECK_MS = 10000;\nexport default function Polling() {\n  _s();\n  var _ref7, _getChainInfo;\n  const {\n    chainId\n  } = useWeb3React();\n  const blockNumber = useBlockNumber();\n  const [isMounting, setIsMounting] = useState(false);\n  const [isHover, setIsHover] = useState(false);\n  const machineTime = useMachineTimeMs(NETWORK_HEALTH_CHECK_MS);\n  const blockTime = useCurrentBlockTimestamp();\n  const isNftPage = useIsNftPage();\n  const isLandingPage = useIsLandingPage();\n  const waitMsBeforeWarning = (_ref7 = chainId ? (_getChainInfo = getChainInfo(chainId)) === null || _getChainInfo === void 0 ? void 0 : _getChainInfo.blockWaitMsBeforeWarning : DEFAULT_MS_BEFORE_WARNING) !== null && _ref7 !== void 0 ? _ref7 : DEFAULT_MS_BEFORE_WARNING;\n  const warning = Boolean(!!blockTime && machineTime - blockTime.mul(1000).toNumber() > waitMsBeforeWarning);\n  useEffect(() => {\n    if (!blockNumber) {\n      return;\n    }\n    setIsMounting(true);\n    const mountingTimer = setTimeout(() => setIsMounting(false), 1000);\n\n    // this will clear Timeout when component unmount like in willComponentUnmount\n    return () => {\n      clearTimeout(mountingTimer);\n    };\n  }, [blockNumber] //useEffect will run only one time\n  //if you pass a value to array, like this [data] than clearTimeout will run every time this value changes (useEffect re-run)\n  );\n\n  //TODO - chainlink gas oracle is really slow. Can we get a better data source?\n\n  const blockExternalLinkHref = useMemo(() => {\n    if (!chainId || !blockNumber) return '';\n    return getExplorerLink(chainId, blockNumber.toString(), ExplorerDataType.BLOCK);\n  }, [blockNumber, chainId]);\n  if (isNftPage || isLandingPage) {\n    return null;\n  }\n  return /*#__PURE__*/_jsxDEV(RowFixed, {\n    children: [/*#__PURE__*/_jsxDEV(StyledPolling, {\n      onMouseEnter: () => setIsHover(true),\n      onMouseLeave: () => setIsHover(false),\n      children: [/*#__PURE__*/_jsxDEV(StyledPollingBlockNumber, {\n        breathe: isMounting,\n        hovering: isHover,\n        warning: warning,\n        children: /*#__PURE__*/_jsxDEV(ExternalLink, {\n          href: blockExternalLinkHref,\n          children: /*#__PURE__*/_jsxDEV(MouseoverTooltip, {\n            text: /*#__PURE__*/_jsxDEV(Trans, {\n              id: \"The most recent block number on this network. Prices update on every block.\"\n            }, void 0, false, void 0, this),\n            children: [blockNumber, \"\\u2002\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(StyledPollingDot, {\n        warning: warning,\n        children: isMounting && /*#__PURE__*/_jsxDEV(Spinner, {\n          warning: warning\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 60\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this), ' ']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this), warning && /*#__PURE__*/_jsxDEV(ChainConnectivityWarning, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 19\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 148,\n    columnNumber: 5\n  }, this);\n}\n_s(Polling, \"3NiHooVwzrkUvoT64CmIFgYU53I=\", false, function () {\n  return [useWeb3React, useBlockNumber, useMachineTimeMs, useCurrentBlockTimestamp, useIsNftPage, useIsLandingPage];\n});\n_c = Polling;\nvar _c;\n$RefreshReg$(_c, \"Polling\");","map":{"version":3,"names":["useWeb3React","RowFixed","getChainInfo","useCurrentBlockTimestamp","useIsLandingPage","useIsNftPage","useMachineTimeMs","useBlockNumber","useEffect","useMemo","useState","ExternalLink","ThemedText","ExplorerDataType","getExplorerLink","MouseoverTooltip","ChainConnectivityWarning","StyledPolling","styled","div","theme","textTertiary","breakpoint","md","StyledPollingBlockNumber","DeprecatedSmall","warning","deprecated_yellow3","accentSuccess","breathe","hovering","StyledPollingDot","rotate360","keyframes","Spinner","DEFAULT_MS_BEFORE_WARNING","NETWORK_HEALTH_CHECK_MS","Polling","chainId","blockNumber","isMounting","setIsMounting","isHover","setIsHover","machineTime","blockTime","isNftPage","isLandingPage","waitMsBeforeWarning","blockWaitMsBeforeWarning","Boolean","mul","toNumber","mountingTimer","setTimeout","clearTimeout","blockExternalLinkHref","toString","BLOCK"],"sources":["/home/diep/freelance/interface/src/components/Polling/index.tsx"],"sourcesContent":["import { Trans } from '@lingui/macro'\nimport { useWeb3React } from '@web3-react/core'\nimport { RowFixed } from 'components/Row'\nimport { getChainInfo } from 'constants/chainInfo'\nimport useCurrentBlockTimestamp from 'hooks/useCurrentBlockTimestamp'\nimport { useIsLandingPage } from 'hooks/useIsLandingPage'\nimport { useIsNftPage } from 'hooks/useIsNftPage'\nimport useMachineTimeMs from 'hooks/useMachineTime'\nimport useBlockNumber from 'lib/hooks/useBlockNumber'\nimport ms from 'ms.macro'\nimport { useEffect, useMemo, useState } from 'react'\nimport styled, { keyframes } from 'styled-components/macro'\nimport { ExternalLink, ThemedText } from 'theme'\nimport { ExplorerDataType, getExplorerLink } from 'utils/getExplorerLink'\n\nimport { MouseoverTooltip } from '../Tooltip'\nimport { ChainConnectivityWarning } from './ChainConnectivityWarning'\n\nconst StyledPolling = styled.div`\n  align-items: center;\n  bottom: 0;\n  color: ${({ theme }) => theme.textTertiary};\n  display: none;\n  padding: 1rem;\n  position: fixed;\n  right: 0;\n  transition: 250ms ease color;\n\n  a {\n    color: unset;\n  }\n  a:hover {\n    color: unset;\n    text-decoration: none;\n  }\n\n  @media screen and (min-width: ${({ theme }) => theme.breakpoint.md}px) {\n    display: flex;\n  }\n`\nconst StyledPollingBlockNumber = styled(ThemedText.DeprecatedSmall)<{\n  breathe: boolean\n  hovering: boolean\n  warning: boolean\n}>`\n  color: ${({ theme, warning }) => (warning ? theme.deprecated_yellow3 : theme.accentSuccess)};\n  transition: opacity 0.25s ease;\n  opacity: ${({ breathe, hovering }) => (hovering ? 0.7 : breathe ? 1 : 0.5)};\n  :hover {\n    opacity: 1;\n  }\n\n  a {\n    color: unset;\n  }\n  a:hover {\n    text-decoration: none;\n    color: unset;\n  }\n`\nconst StyledPollingDot = styled.div<{ warning: boolean }>`\n  width: 8px;\n  height: 8px;\n  min-height: 8px;\n  min-width: 8px;\n  border-radius: 50%;\n  position: relative;\n  background-color: ${({ theme, warning }) => (warning ? theme.deprecated_yellow3 : theme.accentSuccess)};\n  transition: 250ms ease background-color;\n`\n\nconst rotate360 = keyframes`\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n`\n\nconst Spinner = styled.div<{ warning: boolean }>`\n  animation: ${rotate360} 1s cubic-bezier(0.83, 0, 0.17, 1) infinite;\n  transform: translateZ(0);\n\n  border-top: 1px solid transparent;\n  border-right: 1px solid transparent;\n  border-bottom: 1px solid transparent;\n  border-left: 2px solid ${({ theme, warning }) => (warning ? theme.deprecated_yellow3 : theme.accentSuccess)};\n  background: transparent;\n  width: 14px;\n  height: 14px;\n  border-radius: 50%;\n  position: relative;\n  transition: 250ms ease border-color;\n\n  left: -3px;\n  top: -3px;\n`\n\nconst DEFAULT_MS_BEFORE_WARNING = ms`10m`\nconst NETWORK_HEALTH_CHECK_MS = ms`10s`\n\nexport default function Polling() {\n  const { chainId } = useWeb3React()\n  const blockNumber = useBlockNumber()\n  const [isMounting, setIsMounting] = useState(false)\n  const [isHover, setIsHover] = useState(false)\n  const machineTime = useMachineTimeMs(NETWORK_HEALTH_CHECK_MS)\n  const blockTime = useCurrentBlockTimestamp()\n  const isNftPage = useIsNftPage()\n  const isLandingPage = useIsLandingPage()\n\n  const waitMsBeforeWarning =\n    (chainId ? getChainInfo(chainId)?.blockWaitMsBeforeWarning : DEFAULT_MS_BEFORE_WARNING) ?? DEFAULT_MS_BEFORE_WARNING\n\n  const warning = Boolean(!!blockTime && machineTime - blockTime.mul(1000).toNumber() > waitMsBeforeWarning)\n\n  useEffect(\n    () => {\n      if (!blockNumber) {\n        return\n      }\n\n      setIsMounting(true)\n      const mountingTimer = setTimeout(() => setIsMounting(false), 1000)\n\n      // this will clear Timeout when component unmount like in willComponentUnmount\n      return () => {\n        clearTimeout(mountingTimer)\n      }\n    },\n    [blockNumber] //useEffect will run only one time\n    //if you pass a value to array, like this [data] than clearTimeout will run every time this value changes (useEffect re-run)\n  )\n\n  //TODO - chainlink gas oracle is really slow. Can we get a better data source?\n\n  const blockExternalLinkHref = useMemo(() => {\n    if (!chainId || !blockNumber) return ''\n    return getExplorerLink(chainId, blockNumber.toString(), ExplorerDataType.BLOCK)\n  }, [blockNumber, chainId])\n\n  if (isNftPage || isLandingPage) {\n    return null\n  }\n\n  return (\n    <RowFixed>\n      <StyledPolling onMouseEnter={() => setIsHover(true)} onMouseLeave={() => setIsHover(false)}>\n        <StyledPollingBlockNumber breathe={isMounting} hovering={isHover} warning={warning}>\n          <ExternalLink href={blockExternalLinkHref}>\n            <MouseoverTooltip\n              text={<Trans>The most recent block number on this network. Prices update on every block.</Trans>}\n            >\n              {blockNumber}&ensp;\n            </MouseoverTooltip>\n          </ExternalLink>\n        </StyledPollingBlockNumber>\n        <StyledPollingDot warning={warning}>{isMounting && <Spinner warning={warning} />}</StyledPollingDot>{' '}\n      </StyledPolling>\n      {warning && <ChainConnectivityWarning />}\n    </RowFixed>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}