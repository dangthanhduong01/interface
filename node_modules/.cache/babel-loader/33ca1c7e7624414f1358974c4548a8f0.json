{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport { CurrencyAmount, Price, TradeType } from '@uniswap/sdk-core';\nimport { useWeb3React } from '@web3-react/core';\nimport { SupportedChainId } from 'constants/chains';\nimport tryParseCurrencyAmount from 'lib/utils/tryParseCurrencyAmount';\nimport { useMemo, useRef } from 'react';\nimport { RouterPreference } from 'state/routing/slice';\nimport { useRoutingAPITrade } from 'state/routing/useRoutingAPITrade';\nimport { CUSD_CELO, DAI_OPTIMISM, USDC_ARBITRUM, USDC_MAINNET, USDC_POLYGON, USDT_BSC } from '../constants/tokens';\n\n// Stablecoin amounts used when calculating spot price for a given currency.\n// The amount is large enough to filter low liquidity pairs.\nconst STABLECOIN_AMOUNT_OUT = {\n  [SupportedChainId.MAINNET]: CurrencyAmount.fromRawAmount(USDC_MAINNET, 100000e6),\n  [SupportedChainId.ARBITRUM_ONE]: CurrencyAmount.fromRawAmount(USDC_ARBITRUM, 10000e6),\n  [SupportedChainId.OPTIMISM]: CurrencyAmount.fromRawAmount(DAI_OPTIMISM, 10000e18),\n  [SupportedChainId.POLYGON]: CurrencyAmount.fromRawAmount(USDC_POLYGON, 10000e6),\n  [SupportedChainId.CELO]: CurrencyAmount.fromRawAmount(CUSD_CELO, 10000e18),\n  [SupportedChainId.BNB]: CurrencyAmount.fromRawAmount(USDT_BSC, 100e18)\n};\n\n/**\n * Returns the price in USDC of the input currency\n * @param currency currency to compute the USDC price of\n */\nexport default function useStablecoinPrice(currency) {\n  _s();\n  const chainId = currency === null || currency === void 0 ? void 0 : currency.chainId;\n  const amountOut = chainId ? STABLECOIN_AMOUNT_OUT[chainId] : undefined;\n  const stablecoin = amountOut === null || amountOut === void 0 ? void 0 : amountOut.currency;\n  const {\n    trade\n  } = useRoutingAPITrade(TradeType.EXACT_OUTPUT, amountOut, currency, RouterPreference.PRICE);\n  const price = useMemo(() => {\n    if (!currency || !stablecoin) {\n      return undefined;\n    }\n\n    // handle usdc\n    if (currency === null || currency === void 0 ? void 0 : currency.wrapped.equals(stablecoin)) {\n      return new Price(stablecoin, stablecoin, '1', '1');\n    }\n    if (trade) {\n      const {\n        numerator,\n        denominator\n      } = trade.routes[0].midPrice;\n      return new Price(currency, stablecoin, denominator, numerator);\n    }\n    return undefined;\n  }, [currency, stablecoin, trade]);\n  const lastPrice = useRef(price);\n  if (!price || !lastPrice.current || !price.equalTo(lastPrice.current) || !price.baseCurrency.equals(lastPrice.current.baseCurrency)) {\n    lastPrice.current = price;\n  }\n  return lastPrice.current;\n}\n_s(useStablecoinPrice, \"ORRLUsejA2u/JK9xsVgN9pQFqB0=\", false, function () {\n  return [useRoutingAPITrade];\n});\nexport function useStablecoinValue(currencyAmount) {\n  _s2();\n  const price = useStablecoinPrice(currencyAmount === null || currencyAmount === void 0 ? void 0 : currencyAmount.currency);\n  return useMemo(() => {\n    if (!price || !currencyAmount) return null;\n    try {\n      return price.quote(currencyAmount);\n    } catch (error) {\n      return null;\n    }\n  }, [currencyAmount, price]);\n}\n\n/**\n *\n * @param fiatValue string representation of a USD amount\n * @returns CurrencyAmount where currency is stablecoin on active chain\n */\n_s2(useStablecoinValue, \"09g6p15V0c2CVIZx0MryOcP8kRc=\", false, function () {\n  return [useStablecoinPrice];\n});\nexport function useStablecoinAmountFromFiatValue(fiatValue) {\n  _s3();\n  var _STABLECOIN_AMOUNT_OU;\n  const {\n    chainId\n  } = useWeb3React();\n  const stablecoin = chainId ? (_STABLECOIN_AMOUNT_OU = STABLECOIN_AMOUNT_OUT[chainId]) === null || _STABLECOIN_AMOUNT_OU === void 0 ? void 0 : _STABLECOIN_AMOUNT_OU.currency : undefined;\n  return useMemo(() => {\n    if (fiatValue === null || fiatValue === undefined || !chainId || !stablecoin) {\n      return undefined;\n    }\n\n    // trim for decimal precision when parsing\n    const parsedForDecimals = parseFloat(fiatValue).toFixed(stablecoin.decimals).toString();\n    try {\n      // parse USD string into CurrencyAmount based on stablecoin decimals\n      return tryParseCurrencyAmount(parsedForDecimals, stablecoin);\n    } catch (error) {\n      return undefined;\n    }\n  }, [chainId, fiatValue, stablecoin]);\n}\n_s3(useStablecoinAmountFromFiatValue, \"ARXJQdl1Tr2ytTu0YufD558EwWE=\", false, function () {\n  return [useWeb3React];\n});","map":{"version":3,"names":["CurrencyAmount","Price","TradeType","useWeb3React","SupportedChainId","tryParseCurrencyAmount","useMemo","useRef","RouterPreference","useRoutingAPITrade","CUSD_CELO","DAI_OPTIMISM","USDC_ARBITRUM","USDC_MAINNET","USDC_POLYGON","USDT_BSC","STABLECOIN_AMOUNT_OUT","MAINNET","fromRawAmount","ARBITRUM_ONE","OPTIMISM","POLYGON","CELO","BNB","useStablecoinPrice","currency","chainId","amountOut","undefined","stablecoin","trade","EXACT_OUTPUT","PRICE","price","wrapped","equals","numerator","denominator","routes","midPrice","lastPrice","current","equalTo","baseCurrency","useStablecoinValue","currencyAmount","quote","error","useStablecoinAmountFromFiatValue","fiatValue","parsedForDecimals","parseFloat","toFixed","decimals","toString"],"sources":["/home/diep/freelance/interface/src/hooks/useStablecoinPrice.ts"],"sourcesContent":["import { Currency, CurrencyAmount, Price, Token, TradeType } from '@uniswap/sdk-core'\nimport { useWeb3React } from '@web3-react/core'\nimport { SupportedChainId } from 'constants/chains'\nimport tryParseCurrencyAmount from 'lib/utils/tryParseCurrencyAmount'\nimport { useMemo, useRef } from 'react'\nimport { RouterPreference } from 'state/routing/slice'\nimport { useRoutingAPITrade } from 'state/routing/useRoutingAPITrade'\n\nimport { CUSD_CELO, DAI_OPTIMISM, USDC_ARBITRUM, USDC_MAINNET, USDC_POLYGON, USDT_BSC } from '../constants/tokens'\n\n// Stablecoin amounts used when calculating spot price for a given currency.\n// The amount is large enough to filter low liquidity pairs.\nconst STABLECOIN_AMOUNT_OUT: { [chainId: number]: CurrencyAmount<Token> } = {\n  [SupportedChainId.MAINNET]: CurrencyAmount.fromRawAmount(USDC_MAINNET, 100_000e6),\n  [SupportedChainId.ARBITRUM_ONE]: CurrencyAmount.fromRawAmount(USDC_ARBITRUM, 10_000e6),\n  [SupportedChainId.OPTIMISM]: CurrencyAmount.fromRawAmount(DAI_OPTIMISM, 10_000e18),\n  [SupportedChainId.POLYGON]: CurrencyAmount.fromRawAmount(USDC_POLYGON, 10_000e6),\n  [SupportedChainId.CELO]: CurrencyAmount.fromRawAmount(CUSD_CELO, 10_000e18),\n  [SupportedChainId.BNB]: CurrencyAmount.fromRawAmount(USDT_BSC, 100e18),\n}\n\n/**\n * Returns the price in USDC of the input currency\n * @param currency currency to compute the USDC price of\n */\nexport default function useStablecoinPrice(currency?: Currency): Price<Currency, Token> | undefined {\n  const chainId = currency?.chainId\n  const amountOut = chainId ? STABLECOIN_AMOUNT_OUT[chainId] : undefined\n  const stablecoin = amountOut?.currency\n\n  const { trade } = useRoutingAPITrade(TradeType.EXACT_OUTPUT, amountOut, currency, RouterPreference.PRICE)\n  const price = useMemo(() => {\n    if (!currency || !stablecoin) {\n      return undefined\n    }\n\n    // handle usdc\n    if (currency?.wrapped.equals(stablecoin)) {\n      return new Price(stablecoin, stablecoin, '1', '1')\n    }\n\n    if (trade) {\n      const { numerator, denominator } = trade.routes[0].midPrice\n      return new Price(currency, stablecoin, denominator, numerator)\n    }\n\n    return undefined\n  }, [currency, stablecoin, trade])\n\n  const lastPrice = useRef(price)\n  if (\n    !price ||\n    !lastPrice.current ||\n    !price.equalTo(lastPrice.current) ||\n    !price.baseCurrency.equals(lastPrice.current.baseCurrency)\n  ) {\n    lastPrice.current = price\n  }\n  return lastPrice.current\n}\n\nexport function useStablecoinValue(currencyAmount: CurrencyAmount<Currency> | undefined | null) {\n  const price = useStablecoinPrice(currencyAmount?.currency)\n\n  return useMemo(() => {\n    if (!price || !currencyAmount) return null\n    try {\n      return price.quote(currencyAmount)\n    } catch (error) {\n      return null\n    }\n  }, [currencyAmount, price])\n}\n\n/**\n *\n * @param fiatValue string representation of a USD amount\n * @returns CurrencyAmount where currency is stablecoin on active chain\n */\nexport function useStablecoinAmountFromFiatValue(fiatValue: string | null | undefined) {\n  const { chainId } = useWeb3React()\n  const stablecoin = chainId ? STABLECOIN_AMOUNT_OUT[chainId]?.currency : undefined\n\n  return useMemo(() => {\n    if (fiatValue === null || fiatValue === undefined || !chainId || !stablecoin) {\n      return undefined\n    }\n\n    // trim for decimal precision when parsing\n    const parsedForDecimals = parseFloat(fiatValue).toFixed(stablecoin.decimals).toString()\n    try {\n      // parse USD string into CurrencyAmount based on stablecoin decimals\n      return tryParseCurrencyAmount(parsedForDecimals, stablecoin)\n    } catch (error) {\n      return undefined\n    }\n  }, [chainId, fiatValue, stablecoin])\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}