{"ast":null,"code":"import { ListingStatus } from 'nft/types';\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nexport const useNFTList = create()(devtools((set, get) => ({\n  looksRareNonce: 0,\n  listings: [],\n  collectionsRequiringApproval: [],\n  setLooksRareNonce: nonce => set(() => {\n    return {\n      looksRareNonce: nonce\n    };\n  }),\n  getLooksRareNonce: () => {\n    return get().looksRareNonce;\n  },\n  setListings: listings => set(() => {\n    const updatedListings = listings.map(listing => {\n      const oldListing = get().listings.find(oldListing => oldListing.asset.asset_contract.address === listing.asset.asset_contract.address && oldListing.asset.tokenId === listing.asset.tokenId && oldListing.marketplace.name === listing.marketplace.name && oldListing.price === listing.price);\n      const oldStatus = oldListing === null || oldListing === void 0 ? void 0 : oldListing.status;\n      const oldCallback = oldListing === null || oldListing === void 0 ? void 0 : oldListing.callback;\n      const status = () => {\n        switch (oldStatus) {\n          case ListingStatus.APPROVED:\n            return ListingStatus.APPROVED;\n          case ListingStatus.FAILED:\n            return listing.status === ListingStatus.SIGNING ? ListingStatus.SIGNING : ListingStatus.FAILED;\n          case ListingStatus.REJECTED:\n            return listing.status === ListingStatus.SIGNING ? ListingStatus.SIGNING : ListingStatus.REJECTED;\n          default:\n            return listing.status;\n        }\n      };\n      return {\n        ...listing,\n        status: status(),\n        callback: oldCallback !== null && oldCallback !== void 0 ? oldCallback : listing.callback\n      };\n    });\n    return {\n      listings: updatedListings\n    };\n  }),\n  setCollectionsRequiringApproval: collections => set(() => {\n    const updatedCollections = collections.map(collection => {\n      const oldCollection = get().collectionsRequiringApproval.find(oldCollection => oldCollection.collectionAddress === collection.collectionAddress && oldCollection.marketplace.name === collection.marketplace.name);\n      const oldStatus = oldCollection === null || oldCollection === void 0 ? void 0 : oldCollection.status;\n      const oldCallback = oldCollection === null || oldCollection === void 0 ? void 0 : oldCollection.callback;\n      const status = () => {\n        switch (oldStatus) {\n          case ListingStatus.APPROVED:\n            return ListingStatus.APPROVED;\n          case ListingStatus.FAILED:\n            return collection.status === ListingStatus.SIGNING ? ListingStatus.SIGNING : ListingStatus.FAILED;\n          case ListingStatus.REJECTED:\n            return collection.status === ListingStatus.SIGNING ? ListingStatus.SIGNING : ListingStatus.REJECTED;\n          default:\n            return collection.status;\n        }\n      };\n      return {\n        ...collection,\n        status: status(),\n        callback: oldCallback !== null && oldCallback !== void 0 ? oldCallback : collection.callback\n      };\n    });\n    return {\n      collectionsRequiringApproval: updatedCollections\n    };\n  }),\n  setListingStatusAndCallback: (listing, status, callback) => set(_ref => {\n    let {\n      listings\n    } = _ref;\n    const listingsCopy = [...listings];\n    const oldListingIndex = listingsCopy.findIndex(oldListing => oldListing.name === listing.name && oldListing.price === listing.price && oldListing.marketplace.name === listing.marketplace.name);\n    if (oldListingIndex > -1) {\n      const updatedListing = {\n        ...listings[oldListingIndex],\n        status,\n        callback: callback !== null && callback !== void 0 ? callback : listings[oldListingIndex].callback\n      };\n      listingsCopy.splice(oldListingIndex, 1, updatedListing);\n    }\n    return {\n      listings: listingsCopy\n    };\n  }),\n  setCollectionStatusAndCallback: (collection, status, callback) => set(_ref2 => {\n    let {\n      collectionsRequiringApproval\n    } = _ref2;\n    const collectionsCopy = [...collectionsRequiringApproval];\n    const oldCollectionIndex = collectionsCopy.findIndex(oldCollection => oldCollection.name === collection.name && oldCollection.marketplace.name === collection.marketplace.name);\n    if (oldCollectionIndex > -1) {\n      const updatedCollection = {\n        ...collectionsCopy[oldCollectionIndex],\n        status,\n        callback: callback !== null && callback !== void 0 ? callback : collectionsCopy[oldCollectionIndex].callback\n      };\n      collectionsCopy.splice(oldCollectionIndex, 1, updatedCollection);\n    }\n    return {\n      collectionsRequiringApproval: collectionsCopy\n    };\n  })\n})));","map":{"version":3,"names":["ListingStatus","create","devtools","useNFTList","set","get","looksRareNonce","listings","collectionsRequiringApproval","setLooksRareNonce","nonce","getLooksRareNonce","setListings","updatedListings","map","listing","oldListing","find","asset","asset_contract","address","tokenId","marketplace","name","price","oldStatus","status","oldCallback","callback","APPROVED","FAILED","SIGNING","REJECTED","setCollectionsRequiringApproval","collections","updatedCollections","collection","oldCollection","collectionAddress","setListingStatusAndCallback","listingsCopy","oldListingIndex","findIndex","updatedListing","splice","setCollectionStatusAndCallback","collectionsCopy","oldCollectionIndex","updatedCollection"],"sources":["/home/diep/freelance/interface/src/nft/hooks/useNFTList.ts"],"sourcesContent":["import { CollectionRow, ListingRow, ListingStatus } from 'nft/types'\nimport { create } from 'zustand'\nimport { devtools } from 'zustand/middleware'\n\ninterface NFTListState {\n  looksRareNonce: number\n  listings: ListingRow[]\n  collectionsRequiringApproval: CollectionRow[]\n  setLooksRareNonce: (nonce: number) => void\n  getLooksRareNonce: () => number\n  setListings: (listings: ListingRow[]) => void\n  setCollectionsRequiringApproval: (collections: CollectionRow[]) => void\n  setListingStatusAndCallback: (listing: ListingRow, status: ListingStatus, callback?: () => Promise<void>) => void\n  setCollectionStatusAndCallback: (\n    collection: CollectionRow,\n    status: ListingStatus,\n    callback?: () => Promise<void>\n  ) => void\n}\n\nexport const useNFTList = create<NFTListState>()(\n  devtools((set, get) => ({\n    looksRareNonce: 0,\n    listings: [],\n    collectionsRequiringApproval: [],\n    setLooksRareNonce: (nonce) =>\n      set(() => {\n        return { looksRareNonce: nonce }\n      }),\n    getLooksRareNonce: () => {\n      return get().looksRareNonce\n    },\n    setListings: (listings) =>\n      set(() => {\n        const updatedListings = listings.map((listing) => {\n          const oldListing = get().listings.find(\n            (oldListing) =>\n              oldListing.asset.asset_contract.address === listing.asset.asset_contract.address &&\n              oldListing.asset.tokenId === listing.asset.tokenId &&\n              oldListing.marketplace.name === listing.marketplace.name &&\n              oldListing.price === listing.price\n          )\n          const oldStatus = oldListing?.status\n          const oldCallback = oldListing?.callback\n          const status = () => {\n            switch (oldStatus) {\n              case ListingStatus.APPROVED:\n                return ListingStatus.APPROVED\n              case ListingStatus.FAILED:\n                return listing.status === ListingStatus.SIGNING ? ListingStatus.SIGNING : ListingStatus.FAILED\n              case ListingStatus.REJECTED:\n                return listing.status === ListingStatus.SIGNING ? ListingStatus.SIGNING : ListingStatus.REJECTED\n              default:\n                return listing.status\n            }\n          }\n          return {\n            ...listing,\n            status: status(),\n            callback: oldCallback ?? listing.callback,\n          }\n        })\n        return {\n          listings: updatedListings,\n        }\n      }),\n    setCollectionsRequiringApproval: (collections) =>\n      set(() => {\n        const updatedCollections = collections.map((collection) => {\n          const oldCollection = get().collectionsRequiringApproval.find(\n            (oldCollection) =>\n              oldCollection.collectionAddress === collection.collectionAddress &&\n              oldCollection.marketplace.name === collection.marketplace.name\n          )\n          const oldStatus = oldCollection?.status\n          const oldCallback = oldCollection?.callback\n          const status = () => {\n            switch (oldStatus) {\n              case ListingStatus.APPROVED:\n                return ListingStatus.APPROVED\n              case ListingStatus.FAILED:\n                return collection.status === ListingStatus.SIGNING ? ListingStatus.SIGNING : ListingStatus.FAILED\n              case ListingStatus.REJECTED:\n                return collection.status === ListingStatus.SIGNING ? ListingStatus.SIGNING : ListingStatus.REJECTED\n              default:\n                return collection.status\n            }\n          }\n          return {\n            ...collection,\n            status: status(),\n            callback: oldCallback ?? collection.callback,\n          }\n        })\n        return {\n          collectionsRequiringApproval: updatedCollections,\n        }\n      }),\n    setListingStatusAndCallback: (listing, status, callback) =>\n      set(({ listings }) => {\n        const listingsCopy = [...listings]\n        const oldListingIndex = listingsCopy.findIndex(\n          (oldListing) =>\n            oldListing.name === listing.name &&\n            oldListing.price === listing.price &&\n            oldListing.marketplace.name === listing.marketplace.name\n        )\n        if (oldListingIndex > -1) {\n          const updatedListing = {\n            ...listings[oldListingIndex],\n            status,\n            callback: callback ?? listings[oldListingIndex].callback,\n          }\n          listingsCopy.splice(oldListingIndex, 1, updatedListing)\n        }\n        return {\n          listings: listingsCopy,\n        }\n      }),\n    setCollectionStatusAndCallback: (collection, status, callback) =>\n      set(({ collectionsRequiringApproval }) => {\n        const collectionsCopy = [...collectionsRequiringApproval]\n        const oldCollectionIndex = collectionsCopy.findIndex(\n          (oldCollection) =>\n            oldCollection.name === collection.name && oldCollection.marketplace.name === collection.marketplace.name\n        )\n        if (oldCollectionIndex > -1) {\n          const updatedCollection = {\n            ...collectionsCopy[oldCollectionIndex],\n            status,\n            callback: callback ?? collectionsCopy[oldCollectionIndex].callback,\n          }\n          collectionsCopy.splice(oldCollectionIndex, 1, updatedCollection)\n        }\n        return {\n          collectionsRequiringApproval: collectionsCopy,\n        }\n      }),\n  }))\n)\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}